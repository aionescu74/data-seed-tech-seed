<?php//1. Pagina jobReports.php se executa o data pe zi cu CRON si trimite emailuri pentru toate rapoartele unde criteriul COUNT este mai mic decat MIN sau mai mare decat MAX.//2. Configurare CRON job://15	10	*	*	*	wget -O /dev/null https://data-seed.tech/jobReports.php >/dev/null 2>&1//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// THIS PAGE IS CALLED WITH require_once// -> with require_once variable valuess from main page are replaced with the ones from called script// -> so use project related unique names////error_reporting(E_ALL);//require_once("/home/dataseed/public_html/connection.inc");//require_once("/home/dataseed/public_html/seed/environment.inc");//require_once("/home/dataseed/public_html/seed/xml_functions.inc");//require_once("/home/dataseed/public_html/seed/messaging.inc");require_once("./connection.inc");//require_once("./environment.inc");require_once("./xml_functions.inc");require_once("./messaging.inc");$SEED_URL = "https://data-seed.tech/seed/";$sel_rapoarte = "SELECT *            FROM seed_app_reports             WHERE LENGTH(sendEmail) > 3;";//print $sel_rapoarte;$result_rapoarte  = $conn -> query($sel_rapoarte);while ($row_raport = $result_rapoarte ->fetch_object()){    $sendEmail           = $row_raport->sendEmail;    $reportId           = $row_raport->reportId; //reportId    $appCode            = $row_raport->appCode;    $reportName         = $row_raport->reportName; //reportName    $reportDescription  = $row_raport->reportDescription; //reportDescription       $activationCriteria  = $row_raport->activationCriteria; //activationCriteria    $slowExecution     = $row_raport->slowExecution; //slowExecution    //$environment_sql    = $row_raport->environment;    $sqlMinCondition   = $row_raport->sqlMinCondition; //sqlMinCondition    $sqlMaxCondition   = $row_raport->sqlMaxCondition; //sqlMaxCondition    $priority         = $row_raport->priority; //priority    $sqlReport         = $row_raport->sqlReport; //sqlReport    //$root_element_name  = $row_raport->xml_root_element_name;    //$element_name       = $row_raport->xml_element_name;    $linkAddress       = $row_raport->linkAddress; //linkAddress    $linkId            = $row_raport->linkId; //linkId        $query  = $activationCriteria;    $result = $conn -> query($query);    $row    = $result ->fetch_row();    $count  = $row[0];    $query  = $sqlMinCondition;    $result = $conn -> query($query);    $row    = $result ->fetch_row();    $conditie_min= $row[0];    $query  = $sqlMaxCondition;    $result = $conn -> query($query);    $row    = $result ->fetch_row();    $conditie_max= $row[0];    ///////////////////////////////////////////////////    //                      CREMA    //////////////////////////////////////////////////    if($count < $conditie_min || $count > $conditie_max)    {        //$result1 = $conn -> query($sqlReport);        $xml = GetXMLfromQuery($conn, $sqlReport, "records", "record");        $proc = new XSLTProcessor();        $xslTabel = GetXSLTable("records", "record", "", "", "", "");        $proc->importStyleSheet($xslTabel);        $xmlTabeljobReports = $proc->transformToXML($xml);        $subject = "[PRIO " . $priority . "] " . $reportName . ": " . $count;        $body    = "<html>                    <head>                    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />                    <style>                        #email-wrap {                            background: #151515;                            color: #FFF;                        }                        table.xml_table{                            width:99%;                            border: 1px solid #c0c0c0;                            border-collapse: collapse;                            text-align:left;                            background-color:#f0f8ff;                        }                        table.xml_table td{                            padding: 5px;                            font-size: 11px;                            border: 1px solid #c0c0c0;                        }                        table.xml_table tr:hover{                            background-color: #e6f2ff                        }                        table.xml_table th{                            background-color: #4CAF50;                            color: white;                            padding: 5px;                            font-size: 12px;                        }                    </style>                    </head>                    <body><br/>"                . "Report: <a target=\"_blank\" href=\"".$SEED_URL."raport_xml.php?app=".$appCode."&id=".$reportId."\">" . $reportName . "</a><br/><br/>"                . "Description: ". $reportDescription . "<br/>"                . "<br/>" . $xmlTabeljobReports. "<br/><br/>"                . "</body></html>";        sendEmail($sendEmail, $subject, $body);                $okNok = 'OK';    }                        }